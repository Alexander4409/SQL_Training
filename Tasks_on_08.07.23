Таблица Prodaves:
ID_Pr - уникальный номер продавца (первичный ключ)
Name_Pr - имя продавца
City_Pr - город в котором проживает продавец
Procent - комисcионные

Таблица Klient:
ID_KL - уникальный номер клиента (первичный ключ)
ID_Pr - уникальный номер продавца
Name_KL - имя клиента
City_KL – город, в котором живет клиент
Obl_KL – страна, в которой проживает клиент
Discoun - скидки

Таблица Zakaz:
ID_Z - уникальный номер заказа (первичный ключ)
ID_Pr – уникальный номер продавца
ID_KL - уникальный номер клиента
SUMMA - сумма заказа
Kol – количество единиц товара
DATA - дата заказа
CITY_Z – город, в который доставляется заказ
Cena_Dostavki - цена доставки заказа


1.С помощью объединения вывести данные о каждом заказчике, для которого определён продавец.
_________________________________________________________________________________
Ответ: select klient.Name_KL, zakaz.*
from klient
join zakaz on klient.ID_KL = zakaz.ID_kl _________________________________________________________________________________
2.Вывести имя заказчика и данные о средней цене доставки для него. Если цена доставки больше средней по таблице написать - lot, меньше – few
_________________________________________________________________________________
Ответ: select klient.Name_KL,zakaz.Cena_Dostavki,
    case
        when Zakaz.Cena_Dostavki > avg_cena_dostavki.avg_cena_dostavki then "alot"
        else "few"
    end as status_delivery
from klient
join zakaz on klient.ID_KL = zakaz.ID_KL
join(
    select avg(cena_dostavki) as avg_cena_dostavki
    from zakaz
)as avg_cena_dostavki
_________________________________________________________________________________
3.Соедините вместе все таблицы с помощью внешнего объединения.
_________________________________________________________________________________
Ответ: 
select *
from Prodaves
full outer join Klient on Prodaves.ID_Pr = Klient.ID_Pr
full outer join Zakaz on Prodaves.ID_Pr = Zakaz.ID_Pr and Klient.ID_KL = Zakaz.ID_KL
_________________________________________________________________________________
4.С помощью объединения вывести данные о скидках клиента для каждого продавца
_________________________________________________________________________________
Ответ: 
select Prodaves.Name_Pr, Klient.Discoun
from Prodaves
left join Klient on Prodaves.ID_Pr = Klient.ID_Pr
_________________________________________________________________________________

5.Напишите запрос, который выведет все города, в которых живут продавцы и заказчики.
_________________________________________________________________________________
Ответ: 
select city_pr from prodaves
union
select city_kl from klient
_________________________________________________________________________________
6.С помощью объединения вывести все данные о заказчиках и  заказах, даже если заказчик не сделал ни одного заказа за указанный период.
_________________________________________________________________________________
Ответ:
select klient.*, zakaz.*
from klient
left join zakaz on klient.ID_KL = zakaz.ID_KL
_________________________________________________________________________________
7.Составьте запроса для вывода имен и кодов всех продавцов, в чьих городах есть покупатели, которых они не обслуживают. С помощью оператора в подзапросе.
_________________________________________________________________________________
Ответ:
select Name_Pr, ID_Pr
from prodaves
where city_Pr not in (
select distinct city_KL
from klient
where klient.ID_Pr = prodaves.ID_Pr
)
_________________________________________________________________________________
8.Напишите запрос, который выведет все города и имена продавцов и заказчиков, которые живут в Лондоне.
_________________________________________________________________________________
Ответ:
select City_Pr, Name_Pr
from Prodaves 
where City_Pr = 'London'
union
select City_KL, Name_KL
from Klient
where City_KL = 'London'
_________________________________________________________________________________
